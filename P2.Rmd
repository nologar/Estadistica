---
title: "Trabajo Inferencia Estadistica"
output: html_document
date: "2024-11-13"
author:
  - No√© L√≥pez garc√≠a
  - Joan Pedro Bruixola
  - Carlos Ribes Garcia
  - Marc Velasco Mateu
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

rm(list=ls())

library(mclust)
```


```{r datos, include=FALSE}
data<-quakes
```

1. Implementa una funci√≥n en R para la funci√≥n de densidad de probabilidad de la distribuci√≥n de mezcla gaussiana. Grafica la funci√≥n de densidad de probabilidad de $GM(2,1,5,1,0.3)$. Puedes usar la funci√≥n incorporada `dnorm` para la funci√≥n de densidad de probabilidad de la distribuci√≥n gaussiana.

```{r ej1, echo=FALSE}
# Establecemos el rango de x
x <- seq(-1, 8, length.out = 500)

# Componentes de la mezcla
densidad1 <- dnorm(x, mean = 2, sd = 1)
densidad2 <- dnorm(x, mean = 5, sd = 1)

# Mezcla ponderada de las densidades
w1 <- 0.3  # Peso de la primera gaussiana
densidad_mezcla <- w1 * densidad1 + (1 - w1) * densidad2

# Graficamos la densidad conjunta
plot(x, densidad_mezcla, type = "l", col = "blue", lwd = 2,
     main = "Densidad de la Mezcla Gaussiana GM(2, 1, 5, 1, 0.3)",
     xlab = "x", ylab = "Densidad")

```


2.Inicialmente, solo observamos los datos de longitud y asumimos que las ubicaciones de longitud son i.i.d. que siguen un modelo de mezcla gaussiana. Estima los cinco par√°metros de la mezcla gaussiana utilizando los 1000 valores observados de longitud. Puedes hacer esto num√©ricamente en R con la funci√≥n `optim`. Grafica la mezcla gaussiana ajustada sobre el histograma de los datos de longitud.

Para encontrar un buen punto inicial para los par√°metros, simplemente puedes observar el histograma de los datos y tratar de adivinar la ubicaci√≥n de las medias $\mu_1$ y $\mu_2$. Una suposici√≥n inicial para $w$ puede ser la proporci√≥n del tama√±o de los dos grupos de datos (o usar $w=0.5$ como suposici√≥n inicial). Tambi√©n puedes probar diferentes valores iniciales y reportar los resultados con la menor log-verosimilitud negativa.

Dado que hay muchos par√°metros, la optimizaci√≥n puede llevar mucho tiempo y es probable que debas aumentar el n√∫mero m√°ximo de iteraciones del algoritmo; de lo contrario, este terminar√° antes de alcanzar un buen √≥ptimo. Puedes hacerlo con `control = list(maxit = 10000)` en la funci√≥n `optim`. Probablemente tambi√©n habr√° muchos *warnings*, principalmente porque los par√°metros deben estar restringidos, especialmente $w$. Puedes ignorar los *warnings*.

```{r}

```


3.Considera ahora otro modelo en el que las ubicaciones de longitud son independientes y distribuidas de manera gaussiana 
ùëÅ(ùúá,ùúé2)N(Œº,œÉ 2 ). Ajusta este modelo a los datos observados de longitud.
```{r}

```


4.Calcula los valores de AIC y BIC para el modelo gaussiano simple y el modelo de mezcla gaussiana para los datos de longitud. ¬øQu√© modelo deber√≠a seleccionarse?

```{r}
# En el simple empleamos las funciones est√°ndar existentes de AIC y BIC

# Emplearemos esta librer√≠a para calcular el AIC y el BIC del modelo de mezcla gaussiana.

```

5.Repite el procedimiento de ajuste anterior para los datos de latitud y profundidad, y realiza la selecci√≥n de modelos como de costumbre utilizando AIC y BIC. ¬øQu√© modelo deber√≠a seleccionarse?
```{r}

```


6.Considera los dos grupos de eventos y calcula el valor medio e intervalos de confianza (95 %) para la media de las longitudes, latitudes y profundidades en los dos grupos (azul y rojo en la Figura 1). ¬øQu√© conclusiones podemos sacar de los intervalos de confianza?
```{r}

```


7.Consideramos ahora la variable n√∫mero de estaciones s√≠smicas que detectaron el evento (stations). ¬øPodemos afirmar que el n√∫mero medio de estaciones que detectaron los eventos es significativamente distinto en los dos grupos de terremotos (a nivel ùõº=0.01Œ±=0.01 y a nivel ùõº=0.1Œ±=0.1)? (Puedes utilizar bootstrap y/o asumir poblaciones normales).

```{r}

```


